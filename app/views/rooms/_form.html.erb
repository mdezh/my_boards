<% cancel_path = @room.id ? room_path(@room) : root_path %>
<% prevent_cancel_request = @room.id ? false: true %>

<%= turbo_frame_tag dom_id(@room), data: {
      controller: "eraser class-changer", eraser_selector_value: "#new_room",
      eraser_prevent_value: prevent_cancel_request,
      class_changer_selector_value: "#add_room_btn",
      class_changer_class_value: "disabled" } do %>
  <%= form_with(model: @room) do |f| %>
    <% invalid = @room.errors.include?(:name) %>
    <%= f.text_field :name, class: "form-control #{'is-invalid' if invalid}", placeholder: "Room name" %>
    <% if invalid %>
      <% @room.errors.full_messages_for(:name).each do |m| %>
        <p class="my-0"><small class="text-danger"><%= m %></small></p>
      <% end %>
    <% end %>

    <% invalid = @room.errors.include?(:description) %>
    <%= f.text_area :description, class: "mt-3 form-control #{'is-invalid' if invalid}", placeholder: "Description"  %>
    <% if invalid %>
      <% @room.errors.full_messages_for(:description).each do |m| %>
        <p class="my-0"><small class="text-danger"><%= m %></small></p>
      <% end %>
    <% end %>

    <div class="mt-3">
      <%= f.submit "Submit", class: "btn btn-primary" %>
      <%= link_to "Cancel", cancel_path, class: "btn btn-secondary cancel-btn",
        data: { action: "click->class-changer#remove click->eraser#erase"} %>
    </div>
  <% end %>
<% end %>
